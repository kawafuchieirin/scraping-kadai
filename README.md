# 🚆 山手線遅延分析プロジェクト

JR東日本の遅延証明書データをスクレイピングし、山手線の遅延パターンを可視化・分析するプロジェクトです。

## 📊 プロジェクト概要

このプロジェクトでは以下を実現します：

- **データ収集**: JR東日本の遅延証明書履歴ページから1ヶ月分のデータを取得
- **データ分析**: 曜日別・時間帯別の遅延傾向を統計的に分析
- **可視化**: ヒートマップやグラフで遅延パターンを視覚的に表現
- **レポート生成**: 分析結果をまとめたMarkdownレポートを自動生成

## 🚀 クイックスタート

### 1. 環境セットアップ

```bash
# 依存関係のインストール
pip install -r requirements.txt
```

### 2. データ収集

```bash
# 過去45日分の遅延履歴データを取得
python src/yamanote_scraper.py
```

### 3-A. Streamlitダッシュボード（推奨）

```bash
# インタラクティブなWebダッシュボードを起動
streamlit run app.py
```

### 3-B. データ分析・可視化（従来の方法）

```bash
# 取得したデータを分析
python src/analyze_data.py data/yamanote_delay_data_YYYYMMDD_HHMMSS.csv
```

## 📁 プロジェクト構造

```
scraping-kadai/
├── src/
│   ├── yamanote_scraper.py    # スクレイピングメインスクリプト
│   └── analyze_data.py        # データ分析・可視化スクリプト
├── data/                      # 取得したCSVデータ
├── output/                    # 生成されたグラフ・レポート
├── app.py                     # Streamlitダッシュボード
├── requirements.txt           # Python依存関係
└── README.md                 # このファイル
```

## 📈 分析結果

### 🌐 Streamlitダッシュボード（推奨）
インタラクティブなWebベースの分析ダッシュボード：
- **概要**: 基本統計とデータの洞察
- **ヒートマップ**: 曜日別・時間帯別遅延率の可視化
- **時間帯別分析**: 4つのグラフによる詳細分析
- **日別傾向**: 遅延パターンの時系列分析
- **データテーブル**: 生データの閲覧・フィルタリング・ダウンロード

### 📊 静的分析結果（従来の方法）
- `weekday_heatmap.png`: 曜日別・時間帯別遅延率ヒートマップ
- `time_analysis.png`: 時間帯別遅延分析（4つのサブプロット）
- `daily_trend.png`: 日別遅延傾向グラフ
- `analysis_report.md`: 分析結果のサマリーレポート

## 🔍 主な分析項目

1. **基本統計**: 遅延発生率、平均遅延時間など
2. **曜日別分析**: どの曜日に遅延が多いか
3. **時間帯別分析**: 朝夕ラッシュの影響
4. **日別傾向**: 特定の日に遅延が集中するパターン
5. **遅延時間分布**: 10分、20分など遅延時間の頻度

## ⚙️ カスタマイズ

### 対象期間の変更

`yamanote_scraper.py`の`main()`関数で対象年月を変更できます：

```python
# 特定の年月を指定
target_year = 2024
target_month = 3
df = scraper.scrape_month_data(target_year, target_month)
```

### 分析項目の追加

`analyze_data.py`の`YamanoteDelayAnalyzer`クラスに新しいメソッドを追加して、独自の分析を実装できます。

## 🛠️ 技術スタック

- **Python 3.8+**
- **requests**: HTTP リクエスト
- **BeautifulSoup4**: HTMLパースィング
- **pandas**: データ処理・分析
- **matplotlib/seaborn**: 静的データ可視化
- **Streamlit**: インタラクティブWebダッシュボード
- **Plotly**: インタラクティブグラフ

## 📝 注意事項

- スクレイピング実行時はサーバーへの負荷を考慮し、適切な間隔（1秒）を空けています
- 実際のJR東日本サイトのURL・構造に応じて、スクリプトの調整が必要な場合があります
- 本プロジェクトは学習・研究目的での使用を想定しています

## 🎯 今後の拡張案

- [ ] 他路線（中央線、総武線等）との比較分析
- [ ] 天候データとの相関分析
- [ ] リアルタイム遅延通知bot
- [ ] Web ダッシュボード化
- [ ] 機械学習による遅延予測
